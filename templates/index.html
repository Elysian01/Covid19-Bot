<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../static/CoronaDetection.js"></script>
    <script>
        var response = '{{ val }}';
        chat = JSON.parse(sessionStorage.getItem("chat"))
        if (chat.length == 1 && response == "Bye")
            console.log("Chat Bot On")
        else {
            user = JSON.parse(sessionStorage.getItem("user"))
                // To disable same o/p by chatbot after refreshing page
            if (user[user.length - 1] != "rasa") {
                updateChat(response, "rasa")
                displayChat()

                if (response == "Covid Test Started.") {
                    console.log("Covid Test Started.")
                }
            }
        }
        window.scrollBy(0, 200);
    </script>


    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <link rel="stylesheet" href="../static/styles.css">

    <title>COVID BOT</title>
</head>

<body>
    <header class="nav-header">
        <div class="heading">
            <h1><span>COVID-19</span> BOT</h1>
        </div>
        <div class="info">
            <h1><a href="#">Repo</a></h1>
        </div>
    </header>

    <br><br>

    <main>
        <div class="container">
            <section class="msger">
                <header class="msger-header">
                    <div class="msger-header-title">
                        <h3> <span>COVID-19</span> BOT</h3>
                    </div>
                    <div class="btns">
                        <button class="btn-danger btn-hover" title="It will delete all the chat" onclick="reset()">Reset</button>
                        <button class="btn-gold btn-hover" title="Wanna see, what all i can do">?</button>
                    </div>

                </header>

                <main class="msger-chat" id="msger-chat">
                    <div class="msg left-msg">
                        <div class="msg-bubble">
                            <div class="msg-text">
                                Hi, I am a COVID bot. ðŸ˜„
                            </div>
                        </div>
                    </div>


                    <!-- <div class="msg left-msg">
                        <div class="msg-bubble">
                            <div class="msg-text">
                                Hi, welcome to SimpleChat! Go ahead and send me a message. ðŸ˜„
                            </div>
                        </div>
                    </div>

                    <div class="msg right-msg">
                        <div class="msg-bubble">
                            <div class="msg-text">
                                You can change your name in JS section!
                            </div>
                        </div>
                    </div> -->

                </main>

                <form class="msger-inputarea" onsubmit="getUserReq(event)">
                    <input type="text" class="msger-input" id="text" name="text" autofocus placeholder="Enter your message...">
                    <button type="submit" class="msger-send-btn">Send</button>
                </form>
            </section>
        </div>

        <br><br><br>
    </main>
    <script src="../static/predictions.js"></script>
    <script>
        const request = document.getElementById("text").value
        if (request != "") {
            const buffer = "<div class='msg right-msg'><div class='msg-bubble'><div class='msg-text'>" + request +
                "</div></div></div><div class='msg left-msg'><div class='msg-bubble'><div class='msg-text'>" + "..." +
                "</div></div></div>"
            document.querySelector(".msger-chat").innerHTML += buffer
        }


        if (msg != "") {
            document.querySelector(".msger-chat").innerHTML += msg
        } else {

            chat = JSON.parse(sessionStorage.getItem("chat"))
            user = JSON.parse(sessionStorage.getItem("user"))
            for (let i = 1; i < user.length; i++) {
                var className = ""
                if (user[i] == "user")
                    className = "msg right-msg"
                else
                    className = "msg left-msg"

                var markdown_chat = chat[i].replace(/&lt;/g, "<")
                var markdown_chat = markdown_chat.replace(/&gt;/g, ">")

                final_msg = "<div class='" + className + "'><div class='msg-bubble'><div class='msg-text'>" +
                    markdown_chat +
                    "</div></div></div>"

                msg += final_msg

            }
            document.querySelector(".msger-chat").innerHTML += msg
        }

        chatWindow = document.querySelector(".msger-chat");
        var xH = chatWindow.scrollHeight;
        chatWindow.scrollTo(0, xH + 100);
    </script>

    <footer id="footer">
        <h2>Made By:</h2>
        <a href="#">
            <h2><span>Abhishek</span> Gupta</h2>
        </a>
        <a href="#">
            <h2><span>Ansh</span> Chaddva</h2>
        </a>

    </footer>

    <script>
        function reset() {
            sessionStorage.clear();
            const banner = "<div class='msg left-msg'><div class='msg-bubble'><div class='msg-text'>" +
                "Hi, I am a COVID bot. ðŸ˜„" +
                "</div></div></div>"
            document.querySelector(".msger-chat").innerHTML = banner
        }


        var element = document.getElementById("footer");
        element.scrollIntoView(false);
    </script>

   
</body>

</html>

<html>